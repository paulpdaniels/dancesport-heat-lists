!function(a){"use strict";var b=angular.module("dancesportHeatLists",["ui.bootstrap","ngRoute"]);b.config(["$routeProvider",function(a){a.when("/about",{templateUrl:"partials/about.html",controller:"AboutController"}).when("/search",{templateUrl:"partials/search.html",controller:"CompetitionController",reloadOnSearch:!1}).otherwise("/search")}]),b.factory("CompetitionService",["$http",function(a){return{getCompetition:function(b){return a.get("dist/competitions/"+b+".json").then(function(a){return angular.fromJson(a.data)})},getCompetitionList:function(){return a.get("dist/competitions/manifest.json").then(function(a){return angular.fromJson(a.data)})}}}]),b.controller("AboutController",["$scope",function(a){}]),b.controller("NavigationController",["$scope","$rootScope","$location",function(a,b,c){a.activeItem="/search",b.$on("$routeChangeSuccess",function(){a.activeItem=c.url()})}]),b.controller("CompetitionController",["$scope","$http","CompetitionService","$location",function(a,b,c,d){function e(){a.selectedCompetition&&c.getCompetition(a.selectedCompetition.key).then(function(b){b.version<4||(a.events=b.events,a.competitors=b.dancers,a.selectedEvent=a.events[0],a.changeEvent())})}function f(a){for(var b=[];a.length>0;)for(var c=a.pop(),d=0,e=a.length;e>d;++d)if(_.includes(a[d].partners,c.$id)&&_.includes(c.partners,a[d].$id)){g(a,d,a.length-1),b.push([c,a.pop()]);break}return b}function g(a,b,c){var d=a[b];a[b]=a[c],a[c]=d}a.competitions=[],a.events=[],a.competitors=[],a.selectedCompetition=null,a.selectedEvent=null,a.selectedCompetitor=null,c.getCompetitionList().then(function(b){a.competitions=b.competitions;for(var c=d.search(),f=0,g=a.competitions.length;g>f&&c.c;++f)c.c===a.competitions[f].key&&(a.selectedCompetition=a.competitions[f]);a.selectedCompetition||(a.selectedCompetition=a.competitions[0]),e()}),a.changeCompetition=function(){e()},a.changeEvent=function(){var b=_.filter(a.competitors,function(b){return _.includes(b.events,a.selectedEvent.$id)});a.selectedCompetitors=f(b)},a.searchEvent=function(b,c,d){a.selectedEvent=_.find(a.events,{$id:b.$id}),a.lookup=a.selectedEvent.name,a.changeEvent()},a.searchCompetitor=function(b,c,d){a.selectedCompetitor=_.find(a.competitors,{$id:b.$id}),a.competitorLookup=a.selectedCompetitor.name};var h={};a.getEvent=function(b){var c=h[b]||_.find(a.events,{$id:b});return c?(h[b]=c,c):void 0}}])}(window);